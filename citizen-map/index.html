<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PERKS Map - IslandDAO Citizen Registry</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: black;
            height: 100vh;
            overflow: hidden;
            color: white;
            margin: 0;
            padding: 0;
        }
        
        #particleCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 75vh;
            touch-action: none;
        }
        
        .container {
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            height: 100vh;
            text-align: center;
        }
        
        .particle-section {
            height: 75vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .content {
            height: 25vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem 2rem;
            background: black;
        }
        
        .subtitle {
            font-size: 1.1rem;
            margin-bottom: 1.5rem;
            opacity: 0.8;
            color: #cccccc;
        }
        
        .buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            border: 1px solid #4CAF50;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #45a049, #3d8b40);
            border: 1px solid #45a049;
        }

        @media (max-width: 768px) {
            .subtitle {
                font-size: 1rem;
            }
            
            .btn {
                padding: 0.8rem 1.5rem;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <canvas id="particleCanvas"></canvas>
    
    <div class="container">
        <div class="particle-section">
            <!-- Particle effects display here -->
        </div>
        <div class="content">
            <p class="subtitle">Explore the IslandDAO citizen registry and NFT collection</p>
            
            <div class="buttons">
                <a href="/verified-citizen-map" class="btn btn-primary">View Citizen Map</a>
                <a href="/collection" class="btn">Browse Collection</a>
            </div>
        </div>
    </div>
    
    <script>
        const canvas = document.getElementById('particleCanvas');
        const ctx = canvas.getContext('2d');
        let particles = [];
        let textImageData = null;
        let mousePosition = { x: 0, y: 0 };
        let isTouching = false;
        let isMobile = window.innerWidth < 768;

        // IslandDAO logo SVG path data (converted from your PNG)
        const ISLAND_LOGO_PATH = "M0 40L20 20L40 40L20 60Z M60 20L80 0L100 20L80 40Z M120 40L140 20L160 40L140 60Z M180 20L200 0L220 20L200 40Z M240 40L260 20L280 40L260 60Z M300 20L320 0L340 20L320 40Z M0 80L340 80L340 100L0 100Z";

        function updateCanvasSize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight * 0.75; // 3/4 of screen height
            isMobile = window.innerWidth < 768;
        }

        function createTextImage() {
            if (!ctx || !canvas) return 0;

            ctx.fillStyle = 'white';
            ctx.save();
            
            const logoHeight = isMobile ? 100 : 150;
            const logoWidth = logoHeight * 3.5; // Proper aspect ratio from your logo
            
            // Center the logo
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            ctx.translate(centerX - logoWidth / 2, centerY - logoHeight / 2);

            const scale = logoHeight / 140; // Base scale on the actual logo height
            ctx.scale(scale, scale);
            
            // Draw IslandDAO logo using proper SVG-like path
            ctx.fillStyle = 'white';
            
            // Palm tree icon - 6 fronds radiating from center
            ctx.beginPath();
            
            // Top frond
            ctx.moveTo(50, 30);
            ctx.bezierCurveTo(45, 10, 55, 10, 50, 30);
            
            // Top-right frond
            ctx.moveTo(50, 30);
            ctx.bezierCurveTo(70, 15, 75, 25, 50, 30);
            
            // Bottom-right frond
            ctx.moveTo(50, 30);
            ctx.bezierCurveTo(70, 45, 75, 35, 50, 30);
            
            // Bottom frond
            ctx.moveTo(50, 30);
            ctx.bezierCurveTo(55, 50, 45, 50, 50, 30);
            
            // Bottom-left frond
            ctx.moveTo(50, 30);
            ctx.bezierCurveTo(30, 45, 25, 35, 50, 30);
            
            // Top-left frond
            ctx.moveTo(50, 30);
            ctx.bezierCurveTo(30, 15, 25, 25, 50, 30);
            
            ctx.fill();
            
            // Trunk
            ctx.fillRect(47, 30, 6, 30);
            
            // Base platform - three lines
            ctx.fillRect(25, 65, 50, 3);
            ctx.fillRect(30, 71, 40, 2);
            ctx.fillRect(35, 76, 30, 2);
            
            // Text "ISLAND DAO" using proper letter spacing
            ctx.font = 'bold 28px Arial';
            ctx.textAlign = 'left';
            
            // ISLAND
            ctx.fillText('I', 120, 45);
            ctx.fillText('S', 135, 45);
            ctx.fillText('L', 150, 45);
            ctx.fillText('A', 165, 45);
            ctx.fillText('N', 180, 45);
            ctx.fillText('D', 195, 45);
            
            // DAO
            ctx.fillText('D', 230, 45);
            ctx.fillText('A', 245, 45);
            ctx.fillText('O', 260, 45);

            ctx.restore();

            textImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            return scale;
        }

        function createParticle(scale) {
            if (!ctx || !canvas || !textImageData) return null;

            const data = textImageData.data;

            for (let attempt = 0; attempt < 100; attempt++) {
                const x = Math.floor(Math.random() * canvas.width);
                const y = Math.floor(Math.random() * canvas.height);

                if (data[(y * canvas.width + x) * 4 + 3] > 128) {
                    return {
                        x: x,
                        y: y,
                        baseX: x,
                        baseY: y,
                        size: Math.random() * 1 + 0.5,
                        color: 'white',
                        scatteredColor: `hsl(${120 + Math.random() * 60}, 70%, ${50 + Math.random() * 30}%)`, // Green gradient variations
                        life: Math.random() * 100 + 50
                    };
                }
            }

            return null;
        }

        function createInitialParticles(scale) {
            const baseParticleCount = 5000;
            const particleCount = Math.floor(baseParticleCount * Math.sqrt((canvas.width * canvas.height) / (1920 * 1080)));
            for (let i = 0; i < particleCount; i++) {
                const particle = createParticle(scale);
                if (particle) particles.push(particle);
            }
        }

        function animate(scale) {
            if (!ctx || !canvas) return;
            
            // Create gradient background
            const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            gradient.addColorStop(0, '#000000');
            gradient.addColorStop(1, '#0a0a0a');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const { x: mouseX, y: mouseY } = mousePosition;
            const maxDistance = 250;

            for (let i = 0; i < particles.length; i++) {
                const p = particles[i];
                const dx = mouseX - p.x;
                const dy = mouseY - p.y;
                const distance = Math.sqrt(dx * dx + dy * dy);

                if (distance < maxDistance && (isTouching || !('ontouchstart' in window))) {
                    const force = (maxDistance - distance) / maxDistance;
                    const angle = Math.atan2(dy, dx);
                    const moveX = Math.cos(angle) * force * 60;
                    const moveY = Math.sin(angle) * force * 60;
                    p.x = p.baseX - moveX;
                    p.y = p.baseY - moveY;
                    
                    // Create dynamic gradient for scattered particles
                    const particleGradient = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, p.size * 3);
                    particleGradient.addColorStop(0, p.scatteredColor);
                    particleGradient.addColorStop(1, 'rgba(76, 175, 80, 0.3)');
                    ctx.fillStyle = particleGradient;
                } else {
                    p.x += (p.baseX - p.x) * 0.12;
                    p.y += (p.baseY - p.y) * 0.12;
                    
                    // White particles with slight glow
                    const whiteGradient = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, p.size * 2);
                    whiteGradient.addColorStop(0, 'rgba(255, 255, 255, 0.9)');
                    whiteGradient.addColorStop(1, 'rgba(255, 255, 255, 0.1)');
                    ctx.fillStyle = whiteGradient;
                }

                ctx.fillRect(p.x - p.size/2, p.y - p.size/2, p.size, p.size);

                p.life--;
                if (p.life <= 0) {
                    const newParticle = createParticle(scale);
                    if (newParticle) {
                        particles[i] = newParticle;
                    } else {
                        particles.splice(i, 1);
                        i--;
                    }
                }
            }

            const baseParticleCount = 6000;
            const targetParticleCount = Math.floor(baseParticleCount * Math.sqrt((canvas.width * canvas.height) / (1920 * 1080)));
            while (particles.length < targetParticleCount) {
                const newParticle = createParticle(scale);
                if (newParticle) particles.push(newParticle);
            }

            requestAnimationFrame(() => animate(scale));
        }

        function initialize() {
            updateCanvasSize();
            const scale = createTextImage();
            createInitialParticles(scale);
            animate(scale);
        }

        // Event listeners
        window.addEventListener('resize', () => {
            updateCanvasSize();
            const newScale = createTextImage();
            particles = [];
            createInitialParticles(newScale);
        });

        canvas.addEventListener('mousemove', (e) => {
            mousePosition = { x: e.clientX, y: e.clientY };
        });

        canvas.addEventListener('touchmove', (e) => {
            if (e.touches.length > 0) {
                e.preventDefault();
                mousePosition = { x: e.touches[0].clientX, y: e.touches[0].clientY };
            }
        }, { passive: false });

        canvas.addEventListener('touchstart', () => {
            isTouching = true;
        });

        canvas.addEventListener('touchend', () => {
            isTouching = false;
            mousePosition = { x: 0, y: 0 };
        });

        canvas.addEventListener('mouseleave', () => {
            if (!('ontouchstart' in window)) {
                mousePosition = { x: 0, y: 0 };
            }
        });

        // Initialize the animation
        initialize();
    </script>
</body>
</html>