<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PERKS Map - IslandDAO Citizen Registry</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: black;
            height: 100vh;
            overflow: hidden;
            color: white;
        }
        
        canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            touch-action: none;
        }
        
        .content {
            position: absolute;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            z-index: 10;
        }
        
        .subtitle {
            font-size: 1rem;
            margin-bottom: 2rem;
            opacity: 0.8;
            color: #cccccc;
        }
        
        .buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            border: 1px solid #4CAF50;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #45a049, #3d8b40);
            border: 1px solid #45a049;
        }

        @media (max-width: 768px) {
            .subtitle {
                font-size: 0.9rem;
            }
            
            .btn {
                padding: 0.8rem 1.5rem;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <canvas id="particleCanvas"></canvas>
    
    <div class="content">
        <p class="subtitle">Explore the IslandDAO citizen registry and NFT collection</p>
        
        <div class="buttons">
            <a href="/verified-citizen-map" class="btn btn-primary">View Citizen Map</a>
            <a href="/collection" class="btn">Browse Collection</a>
        </div>
    </div>
    
    <script>
        const canvas = document.getElementById('particleCanvas');
        const ctx = canvas.getContext('2d');
        const mousePositionRef = { x: 0, y: 0 };
        const isTouchingRef = { current: false };
        let isMobile = window.innerWidth < 768;

        let particles = [];
        let textImageData = null;

        // AWS Logo Path from your uploaded files
        const AWS_LOGO_PATH = "M86 66l2 9c0 3 1 5 3 8v2l-1 3-7 4-2 1-3-1-4-5-3-6c-8 9-18 14-29 14-9 0-16-3-20-8-5-4-8-11-8-19s3-15 9-20c6-6 14-8 25-8a79 79 0 0 1 22 3v-7c0-8-2-13-5-16-3-4-8-5-16-5l-11 1a80 80 0 0 0-14 5h-2c-1 0-2-1-2-3v-5l1-3c0-1 1-2 3-2l12-5 16-2c12 0 20 3 26 8 5 6 8 14 8 25v32zM46 82l10-2c4-1 7-4 10-7l3-6 1-9v-4a84 84 0 0 0-19-2c-6 0-11 1-15 4-3 2-4 6-4 11s1 8 3 11c3 2 6 4 11 4zm80 10-4-1-2-3-23-78-1-4 2-2h10l4 1 2 4 17 66 15-66 2-4 4-1h8l4 1 2 4 16 67 17-67 2-4 4-1h9c2 0 3 1 3 2v2l-1 2-24 78-2 4-4 1h-9l-4-1-1-4-16-65-15 64-2 4-4 1h-9zm129 3a66 66 0 0 1-27-6l-3-3-1-2v-5c0-2 1-3 2-3h2l3 1a54 54 0 0 0 23 5c6 0 11-2 14-4 4-2 5-5 5-9l-2-7-10-5-15-5c-7-2-13-6-16-10a24 24 0 0 1 5-34l10-5a44 44 0 0 1 20-2 110 110 0 0 1 12 3l4 2 3 2 1 4v4c0 3-1 4-2 4l-4-2c-6-2-12-3-19-3-6 0-11 0-14 2s-4 5-4 9c0 3 1 5 3 7s5 4 11 6l14 4c7 3 12 6 15 10s5 9 5 14l-3 12-7 8c-3 3-7 5-11 6l-14 2z M274 144A220 220 0 0 1 4 124c-4-3-1-6 2-4a300 300 0 0 0 263 16c5-2 10 4 5 8z M287 128c-4-5-28-3-38-1-4 0-4-3-1-5 19-13 50-9 53-5 4 5-1 36-18 51-3 2-6 1-5-2 5-10 13-33 9-38z";

        function updateCanvasSize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            isMobile = window.innerWidth < 768;
        }

        function createTextImage() {
            if (!ctx || !canvas) return 0;

            ctx.fillStyle = 'white';
            ctx.save();
            
            const logoHeight = isMobile ? 120 : 200;
            const awsLogoWidth = logoHeight * (283 / 140);
            const totalWidth = awsLogoWidth;
            
            ctx.translate(canvas.width / 2 - totalWidth / 2, canvas.height / 2 - logoHeight / 2);

            // Draw AWS logo
            ctx.save();
            const awsScale = logoHeight / 140;
            ctx.scale(awsScale, awsScale);
            const path = new Path2D(AWS_LOGO_PATH);
            ctx.fill(path);
            ctx.restore();

            ctx.restore();

            textImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            return awsScale;
        }

        function createParticle(scale) {
            if (!ctx || !canvas || !textImageData) return null;

            const data = textImageData.data;

            for (let attempt = 0; attempt < 100; attempt++) {
                const x = Math.floor(Math.random() * canvas.width);
                const y = Math.floor(Math.random() * canvas.height);

                if (data[(y * canvas.width + x) * 4 + 3] > 128) {
                    return {
                        x: x,
                        y: y,
                        baseX: x,
                        baseY: y,
                        size: Math.random() * 1 + 0.5,
                        color: 'white', 
                        scatteredColor: '#4CAF50',
                        life: Math.random() * 100 + 50
                    };
                }
            }

            return null;
        }

        function createInitialParticles(scale) {
            const baseParticleCount = 7000;
            const particleCount = Math.floor(baseParticleCount * Math.sqrt((canvas.width * canvas.height) / (1920 * 1080)));
            for (let i = 0; i < particleCount; i++) {
                const particle = createParticle(scale);
                if (particle) particles.push(particle);
            }
        }

        let animationFrameId;

        function animate(scale) {
            if (!ctx || !canvas) return;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = 'black';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const { x: mouseX, y: mouseY } = mousePositionRef;
            const maxDistance = 240;

            for (let i = 0; i < particles.length; i++) {
                const p = particles[i];
                const dx = mouseX - p.x;
                const dy = mouseY - p.y;
                const distance = Math.sqrt(dx * dx + dy * dy);

                if (distance < maxDistance && (isTouchingRef.current || !('ontouchstart' in window))) {
                    const force = (maxDistance - distance) / maxDistance;
                    const angle = Math.atan2(dy, dx);
                    const moveX = Math.cos(angle) * force * 60;
                    const moveY = Math.sin(angle) * force * 60;
                    p.x = p.baseX - moveX;
                    p.y = p.baseY - moveY;
                    
                    ctx.fillStyle = p.scatteredColor;
                } else {
                    p.x += (p.baseX - p.x) * 0.1;
                    p.y += (p.baseY - p.y) * 0.1;
                    ctx.fillStyle = 'white';
                }

                ctx.fillRect(p.x, p.y, p.size, p.size);

                p.life--;
                if (p.life <= 0) {
                    const newParticle = createParticle(scale);
                    if (newParticle) {
                        particles[i] = newParticle;
                    } else {
                        particles.splice(i, 1);
                        i--;
                    }
                }
            }

            const baseParticleCount = 7000;
            const targetParticleCount = Math.floor(baseParticleCount * Math.sqrt((canvas.width * canvas.height) / (1920 * 1080)));
            while (particles.length < targetParticleCount) {
                const newParticle = createParticle(scale);
                if (newParticle) particles.push(newParticle);
            }

            animationFrameId = requestAnimationFrame(() => animate(scale));
        }

        updateCanvasSize();

        const scale = createTextImage();
        createInitialParticles(scale);
        animate(scale);

        const handleResize = () => {
            updateCanvasSize();
            const newScale = createTextImage();
            particles = [];
            createInitialParticles(newScale);
        };

        const handleMove = (x, y) => {
            mousePositionRef.x = x;
            mousePositionRef.y = y;
        };

        const handleMouseMove = (e) => {
            handleMove(e.clientX, e.clientY);
        };

        const handleTouchMove = (e) => {
            if (e.touches.length > 0) {
                e.preventDefault();
                handleMove(e.touches[0].clientX, e.touches[0].clientY);
            }
        };

        const handleTouchStart = () => {
            isTouchingRef.current = true;
        };

        const handleTouchEnd = () => {
            isTouchingRef.current = false;
            mousePositionRef.x = 0;
            mousePositionRef.y = 0;
        };

        const handleMouseLeave = () => {
            if (!('ontouchstart' in window)) {
                mousePositionRef.x = 0;
                mousePositionRef.y = 0;
            }
        };

        window.addEventListener('resize', handleResize);
        canvas.addEventListener('mousemove', handleMouseMove);
        canvas.addEventListener('touchmove', handleTouchMove, { passive: false });
        canvas.addEventListener('mouseleave', handleMouseLeave);
        canvas.addEventListener('touchstart', handleTouchStart);
        canvas.addEventListener('touchend', handleTouchEnd);
    </script>
</body>
</html>